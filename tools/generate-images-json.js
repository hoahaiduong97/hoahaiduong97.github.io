const fs=require("fs"),path=require("path"),SECRET="g@ll3ry",IMAGES_DIR=path.join(__dirname,"../images"),IMAGE_REGEX=/\.(jpg|jpeg|png|webp)$/i;function encode(e){return Buffer.from([...e].map(((e,n)=>e.charCodeAt(0)^SECRET.charCodeAt(n%SECRET.length)))).toString("base64")}function scan(e,n=""){const i={images:[],children:{}};return fs.readdirSync(e).forEach((s=>{const t=path.join(e,s),r=fs.statSync(t);if(r.isDirectory()){const e=scan(t,path.join(n,s));(e.images.length||Object.keys(e.children).length)&&(i.children[s]=e)}else if(IMAGE_REGEX.test(s)){const e=path.join(n,s).replace(/\\/g,"/");i.images.push({p:encode(e),s:r.size,t:r.mtimeMs})}})),i}fs.writeFileSync(path.join(__dirname,"../images.json"),JSON.stringify(scan(IMAGES_DIR),null,2)),console.log("âœ… images.json encoded");